## Обработка на текст

**Зад 1. 03-a-0200**  <br />Сортирайте /etc/passwd лексикографски по поле UserID.

`sort -t : -k 3 /etc/passwd`

**Зад 2. 03-а-0201** <br />Сортирайте /etc/passwd числово по поле UserID. (Открийте разликите с лексикографската сортировка)

`sort -n -t : -k 3 /etc/passwd`

**Зад 3. 03-а-0210** <br />

Изведете само 1-ва и 5-та колона на файла /etc/passwd спрямо разделител ":".

`cut -d ':' -f 1,5 /etc/passwd`

**Зад 4. 03-а-0211** <br/>

Изведете съдържанието на файла /etc/passwd от 2-ри до 6-ти символ.

`cut -c 2-6 /etc/passwd`

**Зад 5. 03-а-1500** <br />Намерете броя на символите в /etc/passwd. А колко реда има в /etc/passwd?

`wc -m /etc/passwd` пресмята символите <br />`wc -l /etc/passwd` пресмята редовете

**Зад 6. 03-а-2000** <br />

Извадете от файл /etc/passwd:

- първите 12 реда `head -n 12 /etc/passwd`
- първите 26 символа `head -c 26 /etc/passwd`
- всички редове, освен последните 4 `head -n -4 /etc/passwd`
- последните 17 реда `tail -n 17 /etc/passwd`
- 151-я ред `sed -n '159p' /etc/passwd`
- последните 4 символа от 13-ти ред `sed -n '13p' /etc/passwd | tail -c 5`

**Зад 7. 03-а-2100** <br /> Отпечатайте потребителските имена и техните home директории от /etc/passwd.

`cut -d : -f 1,6 /etc/passwd` или <br/>`cat /etc/passwd | awk -F ':' '{ print $1, $6}'`

**Зад 8. 03-а-2110**<br/>

Отпечатайте втората колона на /etc/passwd, разделена спрямо символ '/'.

`cat /etc/passwd | cut -d '/' -f 2`

**Зад 9. 03-а-3000** <br />Запаметете във файл в своята home директория резултатът от командата ls -l изпълнена за вашата home директорията. <br />Сортирайте създадения файла по второ поле (numeric, alphabetically).

`ls -l | sort -k 2 -n > result.txt`

**Зад 10. 03-а-5000**<br/>Отпечатайте 2 реда над вашия ред в /etc/passwd и 3 реда под него // може да стане и без пайпове

`grep 62219 -B 2 -A 3 /etc/passwd`

**Зад 11. 03-а-5001** <br/>Колко хора не се казват Ivan според /etc/passwd

`egrep -v -i -o '\<ivan\>' /etc/passwd | wc -l`

**Зад 12. 03-а-5002** <br/>Изведете имената на хората с второ име по-дълго от 7 (>7) символа според /etc/passwd

`cat /etc/passwd | cut -d : -f 5 | cut -d ',' -f 1 | cut -d ' ' -f 2 | egrep '[a-Z]{8,}'`

**Зад 13. 03-а-5003** <br />Изведете имената на хората с второ име по-късо от 8 (<=7) символа според /etc/passwd // !(>7) = ?

`cat /etc/passwd | cut -d : -f 5 | cut -d ',' -f 1 | cut -d ' ' -f 2 | egrep -v '[a-Z]{8,}'`

**Зад 14. 03-а-5004** <br/>Изведете целите редове от /etc/passwd за хората от 03-a-5003

`cat /etc/passwd | egrep -v '.*:.*:*:.*:[a-Z]+ [a-Z]{8,}.*'`

**Зад 15. 03-b-0300** <br/>Намерете факултетния си номер във файлa /etc/passwd.

`cat /etc/passwd | grep "Viliyan Ivanov" | cut -d ':' -f 1 | cut -c 2-`

**Зад 16. 03-b-3000** <br/>Запазете само потребителските имена от /etc/passwd във файл users във вашата home директория.

`cat /etc/passwd | cut -d ':' -f 1 > ~/users.txt`

**Зад 17. 03-b-3450** <br/>Колко коментара има във файла /etc/services ? Коментарите се маркират със символа #, след който всеки символ на реда се счита за коментар.

`cat /etc/services | grep "#\s.*" | wc -l`

**Зад 18. 03-b-3450** <br>Вижте man 5 services. Напишете команда, която ви дава името на протокол с порт естествено число N. Командата да не отпечатва нищо, ако търсения порт не съществува (например при порт 1337). Примерно, ако номера на порта N е 69, командата трябва да отпечати tftp.

`cat /etc/services | grep " 69/" | tr -s [:blank:] | cut -d ' ' -f 1 | uniq`

**Зад 19. 03-b-3500** <br/>Колко файлове в /bin са shell script? (Колко файлове в дадена директория са ASCII text?)

`ls -l /bin | cut -c 1-10 | grep x | wc -l`

**Зад 20. 03-b-3600** <br/>Направете списък с директориите на вашата файлова система, до които нямате достъп. Понеже файловата система може да е много голяма, търсете до 3 нива на дълбочина. А до кои директории имате достъп? Колко на брой са директориите, до които нямате достъп?

`find / -mindepth 3 -maxdepth 3 2>&1 1>/dev/null | wc -l` 

**Зад 21. 03-b-4000** <br />Създайте следната файлова йерархия. <br/>/home/SI/s62117/dir1/file1<br/>/home/SI/s62117/dir1/file2<br/>/home/SI/s62117/dir1/file3<br/>

`touch /home/SI/s62117/dir/file{1,2,3}` 

Посредством vi въведе съдържание. <br />

Изведете на екрана:

* статистика за броя редове, думи и символи за всеки един файл 

  `wc -l file{1,2,3}; wc -w file{1,2,3}; wc -m file{1,2,3}`

* статистика за броя редове и символи за всички файлове 

  `cat file{1,2,3} | wc -l; cat file{1,2,3} | wc -w; cat file{1,2,3} | wc -m`

* общия брой редове на трите файла

  `cat file{1,2,3} | wc -l`

**Зад 22. 03-b-4001**<br/>Във file2 подменете всички малки букви с главни.

`ggVGU` - Команда във вим

**Зад 23. 03-b-4002** <br/>Във file3 изтрийте всички "1"-ци.

`:%s/1//g` - Команда във вим

**Зад 24. 03-b-4003**<br/>Изведете статистика за най-често срещаните символи в трите файла.

`cat file{1,2,3} | grep -o . | sort | uniq -c | sort -k 1 -nr`

**Зад 25. 03-b-4004** <br/>Направете нов файл с име по ваш избор, който е конкатенация от file{1,2,3}. <br/ ><!--Забележка: съществува решение с едно извикване на определена програма - опитайте да решите задачата чрез него.-->

`cat file{1,2,3} > newfile.txt`

**Зад 26. 03-b-4005** <br />Прочетете текстов файл file1 и направете всички главни букви малки като запишете резултата във file2.

`cat file1 | tr [:upper:] [:lower:] > file2`

**Зад 27. 03-b-5200**<br/>Изтрийте всички срещания на буквата 'a' (lower case) в /etc/passwd и намерете броят на оставащите символи.

`cat /etc/passwd | tr -d 'a' | grep -o . | wc -l`

**Зад 28. 03-b-5300**<br/>Намерете броя на уникалните символи, използвани в имената на потребителите от /etc/passwd.

`cut -d : -f 5 /etc/passwd | cut -d ' ' -f 1,2 | cut -d , -f 1 | grep -o . | sort -u | wc -l`

**Зад 29. 03-b-5400**<br/>Отпечатайте всички редове на файла /etc/passwd, които не съдържат символния низ 'ov'.

`cat /etc/passwd | grep -v 'ov'`

**Зад 30. 03-b-6100**<br/>Отпечатайте последната цифра на UID на всички редове между 28-ми и 46-ред в /etc/passwd.

`cat passwd | head -n 46 | tail -n 18 | cut -d ':' -f 3 | egrep -o '.$'`

**Зад 31. 03-b-6700**<br/>Отпечатайте правата (permissions) и имената на всички файлове, до които имате read достъп, намиращи се в директорията /tmp.

`ls -l /tmp | awk '$1~/r/{print $1" "$9}' | wc -l16`

**Зад 32. 03-b-6900**<br/>Намерете имената на 10-те файла във вашата home директория, чието съдържание е редактирано най-скоро. На първо място трябва да бъде най-скоро редактираният файл. Намерете 10-те най-скоро достъпени файлове. (hint: Unix time)

`find ~ -printf '%T@ %f\n' 2>/dev/null | sort -k 1 -nr | head -n 10 | awk '{ print $2 }'`

**Зад 33. 03-b-7000**<br/>Файловете, които съдържат C код, завършват на `.c`. Колко на брой са те във файловата система (или в избрана директория)? Колко реда C код има в тези файлове?

`find / 2> /dev/null | grep //.c$ | wc -l` - Брой на С файловете

`find / -name '*.c' 2> /dev/null -exec cat {} + | wc -l` - Брой редове на С код

**Зад 34. 03-b-7500**<br/>Даден ви е ASCII текстов файл (например /etc/services). Отпечатайте хистограма на N-те (например 10) най-често срещани думи.

`cat /etc/services | egrep -o '\<[a-Z]+\>' | sort | uniq -c | sort -k 1 -nr | head -n 10`

**Зад 35. 03-b-8000**<br/>Вземете факултетните номера на студентите от СИ и ги запишете във файл si.txt сортирани.

`cat passwd | cut -d ':' -f 1 | egrep -o '[0-9]+' | sort -n > si.txt`

**Зад 36. 03-b-8500**<br/>

За всеки логнат потребител изпишете "Hello, потребител", като ако това е вашият потребител, напишете "Hello, потребител - this is me!".

Пример: <br/>hello, human - this is me! <br/>Hello, s63465<br/>Hello, s64898<br/>

//TODO: Solve this when connected to os-server

**Зад 37. 03-b-8520**<br/>Изпишете имената на студентите от /etc/passwd с главни букви.

`cat /etc/passwd | cut -d ":" -f 5 | sed -r "s/^([a-zA-Z]*\s[a-zA-Z ]*).*$/\1/" | grep -v , | tr '[:lower:]' '[:upper:]'`

**Зад 38. 03-b-8600**<br/>Shell Script-овете са файлове, които по конвенция имат разширение .sh. Всеки такъв файл започва с "#!<interpreter>" , където <interpreter> указва на операционната система какъв интерпретатор да пусне (пр: "#!/bin/bash", "#!/usr/bin/python3 -u"). <br/>Намерете всички .sh файлове и проверете кой е най-често използваният интерпретатор.

`find / -type f -name '*.sh' -readable -exec head -n 1 {} \; 2>/dev/null | grep '^#!' | sort | uniq -c | sort -nr`

**Зад 39. 03-b-8700**<br/>Намерете 5-те най-големи групи подредени по броя на потребителите в тях.

`cat /etc/group | cut -d : -f 4 | awk -F , '{print NF}' > usersCount`

`paste usersCount /etc/group | sort -t $'\t' -k 1 -n -r | head -n 5`

**Зад 40. 03-b-9000**<br/>Направете файл eternity. Намерете всички файлове, които са били модифицирани в последните 15мин (по възможност изключете .).  Запишете във eternity името на файла и часa на последната промяна.

`find / -type f -mmin -15 2>/dev/null | xargs stat --format "%n : %y > eternity"`

**Зад 41. 03-b-9050**<br/>

Копирайте файл /home/tony/population.csv във вашата home директория.

`cp /home/tony/population.csv ~`

**Зад 42. 03-b-9051**<br/>Използвайки файл population.csv, намерете колко е общото население на света през 2008 година. А през 2016?

`cat population.csv | grep ",2008," | sed -r "s/^.+2008,([0-9]*)$/\1/" | awk '{ sum += $1 } END {print sum }'` - 6691190404, а през 2016 е 7413672933

**Зад 43. 03-b-9052**<br/>Използвайки файл population.csv, намерете през коя година в България има най-много население.

`cat population.csv | grep "BGR" | sort -nr -t ',' -k 4 | head -n 1 | awk -F ',' '{print $3; }'`

**Зад 44. 03-b 9053**<br/>Използвайки файл population.csv, намерете коя държава има най-много население през 2016. А коя е с най-малко население?

`cat population.csv | grep ",2016," | sed -r "s/^(.*),.+,([0-9]+)$/\1:\2/" | sort -nr -t ':' -k 2 | head -n 1`

`cat population.csv | grep ",2016," | sed -r "s/^(.*),.+,([0-9]+)$/\1:\2/" | sort -nr -t ':' -k 2 | tail -n 1`

**Зад 45. 03-b-9054**<br/>Използвайки файл population.csv, намерете коя държава е на 42-ро място по население през 1969. Колко е населението й през тази година?

`"$(cat population.csv | grep ",1969," | sed -r "s/^(.*),.+,([0-9]+)$/\1:\2/" | sort -nr -t ':' -k 2 | head -n 42 | tail -n 1 | cut -d ',' -f 1)" population.csv | grep 2016 | cut -d ',' -f4`

**Зад 46. 03-b-9100**<br/>В home директорията си изпълнете командата `curl -o songs.tar.gz "http://fangorn.uni-sofia.bg/misc/songs.tar.gz"`

**Зад 47. 03-b-9101**<br/>Да се разархивира архивът songs.tar.gz в папка songs във вашата home директорията.

`tar -xzvf songs.tar.gz -C ~/songs`

**Зад 48. 03-b-9102**<br/>Да се изведат само имената на песните.

`find ~/songs -name "*.ogg" | sed -r "s/.*- (.*).ogg$/\1/"'`

**Зад 49. 03-b-9103**<br />Имената на песните да се направят с малки букви, да се заменят спейсовете с долни черти и да се сортират.

`find ~/songs -name "*.ogg" | sed -r "s/.*- (.*).ogg$/\1/" | tr '[:upper:]' '[:lower:]' | tr ' ' '_' | sort`

**Зад 50. 03-b-9104**<br/>Да се изведат всички албуми, сортирани по година.

`find ~/songs -name "*.ogg" | sed -r "s/.*\((.*)\).ogg$/\1/" | sort -r -t ',' -k 2`

**Зад 51. 03-b-9105**<br/>Да се преброят/изведат само песните на Beatles и Pink.

`find ~/songs -name "*.ogg" | egrep "(Beatles -|Pink -) (.*).ogg" | cut -d '/' -f 6-`

**Зад 52. 03-b-9106**<br/>Да се направят директории с имената на уникалните групи. За улеснение, имената от две думи да се напишат слято: Beatles, PinkFloyd, Madness

`find ~/songs -name "*.ogg" | sed -r "s/^.*songs\/(.*) -.*$/\1/" | sort | uniq | sed "s/ //" | xargs mkdir`

**Зад 53. 03-b-9200**<br/>Напишете серия от команди, които извеждат детайли за файловете и директориите в текущата директория, които имат същите права за достъп както най-големият файл в /etc директорията.

`find /etc -type f -printf "%s %p %m\n" 2>/dev/null | sort -n | tail -1 | cut -d ' ' -f 3 | xargs find . -maxdepth 1 -perm`

**Зад 54. 03-b-9300**<br/>Дадени са ви 2 списъка с email адреси - първият има 12 валидни адреса, а вторията има само невалидни. Филтрирайте всички адреси, така че да останат само валидните. Колко кратък регулярен израз можете да направите за целта?

```
Валидни email адреси (12 на брой):
email@example.com
firstname.lastname@example.com
email@subdomain.example.com
email@123.123.123.123
1234567890@example.com
email@example-one.com
_______@example.com
email@example.name
email@example.museum
email@example.co.jp
firstname-lastname@example.com
unusually.long.long.name@example.com

Невалидни email адреси:
#@%^%#$@#$@#.com
@example.com
myemail
Joe Smith <email@example.com>
email.example.com
email@example@example.com
.email@example.com
email.@example.com
email..email@example.com
email@-example.com
email@example..com
Abc..123@example.com
(),:;<>[\]@example.com
just"not"right@example.com
this\ is"really"not\allowed@example.com
```

`^[^\.](?!.*(\.)\1{1,})[^@"][a-zA-Z_0-9.-]+[^.]@[^\>-][a-zA-Z_0-9.-]+$`  // Not proud of this regex

**Зад 55. 03-b-9500** <br />

Запишете във файл next потребителското име на човека, който е след вас в изхода на who. Намерете в /etc/passwd допълнителната ифнромация (име, специалност...) и също го запишете във файла next. 

`who | grep 62117 -A 1 | grep -v 62117 | tr -s ' ' | cut -d ' ' -f 1 > next`

